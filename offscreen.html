<!DOCTYPE html>
<html>
<head>
  <title>Offscreen Audio Player</title>
</head>
<body>
  <script>
    // Listen for messages to play audio
    chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {
      if (request.type === 'playAdhan' && request.audioFile) {
        const audio = new Audio(chrome.runtime.getURL(request.audioFile));
        audio.volume = 0.8; // Set reasonable volume
        
        audio.play()
          .then(() => {
            console.log('Adhan playing...');
            if (sendResponse) sendResponse({ status: 'playing' });
          })
          .catch(error => {
            console.error('Error playing adhan:', error);
            if (sendResponse) sendResponse({ status: 'error', error: error.message });
          });
        
        // Clean up after audio finishes
        audio.addEventListener('ended', () => {
          console.log('Adhan finished');
        });
        
        return true; // Keep message channel open
      }
    });
  </script>
</body>
</html>